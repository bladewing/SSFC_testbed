<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!--<!DOCTYPE experiment SYSTEM "src/Config/Config.dtd">-->

<experiment config_version="1.0">
	<title>JMaster3bHTTPonly</title>
	<time type="fixed" limit="300" />
	<repetition number="29" interval_min_wait="10000" wait_for_clients="true" />
	<snmp_tracking>
		<active>true</active>
		<interval>1000</interval>
		<version>2c</version>
		<ignore_beginning>5</ignore_beginning>
		<oid_values>
			<oid value="1.3.6.1.2.1.2.2.1.10.ports" />
			<oid value="1.3.6.1.2.1.2.2.1.16.ports" />
		</oid_values>
	</snmp_tracking>
	<hardware>
		<server daemon="client"     id="1" daemon_ip="192.168.202.1" experiment_ip="192.168.202.1" />
		<server daemon="server"     id="2" daemon_ip="192.168.201.1" experiment_ip="192.168.201.1" />
		<server daemon="controller" id="3" daemon_ip="192.168.204.1" experiment_ip="192.168.204.1" />
		<switch id="4" config_ip="192.168.207.1" experiment_ip="192.168.207.1" snmp_active="true" snmp_connection_port="161" snmp_tracking_ports="1,3,10,11" />
	</hardware>
	<ressources>
		<files>
			<file id="1" name="requestfile.html" size="2097152" />
			<file id="1111" name="contextAdmin/contextAdmin.html" size="2097152" /> <!-- Snort trigger file -->
			<file id="21081990" name="attack" size="3" /> <!-- Snort trigger file -->
		</files>
	</ressources>
	<config>
		<servers>
			<instance hardware="2">
				<quantity>1</quantity>
				<max_connections>-1</max_connections>
				<first_port>29000</first_port>
				<ressource_type>http</ressource_type>
				<ressources>
					<ressource id="1" />
				</ressources>
			</instance>
		</servers>
		<clients>
			<instance hardware="1">
				<quantity>170</quantity>
				<repeat>-1</repeat>
				<interval>1000</interval>
				<interval_type>dynamic</interval_type>
				<priority>0</priority>
				<inform_controller>false</inform_controller>
				<action>
					<type>http</type>
					<server id="2" port="8080" />
					<files>
						<file id="1" />
					</files>
				</action>
			</instance>
			<instance hardware="1">
				<quantity>5</quantity>
				<repeat>-1</repeat>
				<interval>10000</interval>
				<interval_type>dynamic</interval_type>
				<priority>0</priority>
				<inform_controller>false</inform_controller>
				<action>
					<type>http</type>
					<server id="2" port="8080" />
					<files>
						<file id="21081990" />
					</files>
				</action>
			</instance>
		</clients>
		<comapp>
			<module type="ofrest_enabler" mode="black">
				<datapath>21081990</datapath>
				<port_external>1</port_external>
				<port_internal>3</port_internal>
				<port_ids_in>10</port_ids_in>
				<port_ids_out>11</port_ids_out>
			</module>
			<module type="snort_tracker">
				<database_uri>10.1.3.36</database_uri>
				<database_port>3306</database_port>
				<database_name>snort</database_name>
				<database_user>l7sdntest</database_user>
				<database_user_password>l7sdntest</database_user_password>
			</module>
		</comapp>
		<controller port="6633">
			<reset>true</reset>
		</controller>
	</config>
</experiment>
